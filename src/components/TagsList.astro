---
const allPosts = await Astro.glob('../pages/blog/*.mdx');
const AllUniqueTags = [...new Set(allPosts.map((post) => post.frontmatter.tags).flat())];
let tagsCount = {} // for count of posts in each tag

// get count of posts in each tag
allPosts.forEach((post) => {
  post.frontmatter.tags.forEach((tag) => {
    if (!tagsCount[tag]) {
      tagsCount[tag] = 1
    } else {
      tagsCount[tag]++
    }
  })
})
---

<ul class="tag-list">
  {AllUniqueTags.map((tag) => <li class="tag-list__item"><a href={`/tags/${tag}`} class="tag-list__link link link--nav">{`${tag} (${tagsCount[tag]})`}</a></li>)}
</ul>

